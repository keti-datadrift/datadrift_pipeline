# E2E 테스트 케이스

## 로그인·인증 / 네비게이션

### 1. CSRF 토큰 선요청

- Arrange: 로그인 페이지 최초 진입 시 CSRF 토큰이 쿠키에 없는 상태를 만든다.
- Act: `/ko/login`을 로드해 초기 데이터 요청을 수행한다.
- Assert: 페이지 렌더링 과정에서 CSRF 토큰을 가져오기 위한 프록시 요청이 한 번 발생하고 토큰이 저장된다.

### 2. 필수 입력 검증

- Arrange: 로그인 폼의 이메일과 비밀번호를 비워둔 상태로 유지한다.
- Act: 로그인 버튼을 눌러 제출을 시도한다.
- Assert: 브라우저 기본 검증에 의해 제출이 차단되고 필수 입력 경고가 표시된다.

### 3. 로그인 성공 / 리다이렉션

- Arrange: 인증 쿠키가 없는 상태에서 사용자가 `/ko` 루트를 방문할 환경을 준비한다.
- Act: 브라우저에서 `/ko`에 접근한 뒤 동일 세션에서 인증 쿠키(`csrftoken`, `sessionid`, `ls_access_token`, `ls_refresh_token`)를 부여하고 다시 방문한다.
- Assert: 첫 방문은 `/ko/login`으로 리디렉션되고, 두 번째 방문은 `/ko/dashboard`로 이동한다.

### 4. 로그인 실패

- Arrange: 잘못된 자격 증명으로 인해 인증 API가 401을 반환하도록 준비한다.
- Act: 로그인 버튼을 클릭한다.
- Assert: 페이지가 유지되고 사용자에게 오류가 전달되지 않는 현행 동작을 확인해 향후 개선 과제로 기록한다.

### 5. 보호 레이아웃 진입 방지

- Arrange: 인증 토큰 없이 `/ko/dashboard/projects`에 직접 접근하는 브라우저 세션을 준비한다.
- Act: 보호 레이아웃 URL에 직접 접근한다.
- Assert: 서버 응답이 302로 `/ko/login`에 리디렉션되고, 보호 레이아웃 DOM이 렌더링되지 않는다.

### 6. 사이드바 네비게이션

- Arrange: 사이드바 데이터가 정상 로딩된 인증된 세션을 준비한다.
- Act: `데이터`, `모델`, `모니터링` 그룹을 차례로 클릭해 하위 메뉴를 열고 각 메뉴 항목을 선택한다.
- Assert: 선택한 메뉴가 활성화되고 해당 화면으로 이동하며, 하위 메뉴가 적절히 접히거나 펼쳐진다.

### 7. 로그아웃

- Arrange: 로그인된 상태에서 사용자 아바타 드롭다운을 열 수 있는 화면을 띄운다.
- Act: 드롭다운에서 로그아웃 항목을 선택한다.
- Assert: 서버 로그아웃 요청이 성공적으로 처리되고 사용자가 `/ko/login`으로 리디렉션되며 인증 쿠키들이 제거된다.

## 데이터 (레이블링 프로젝트)

### 1. 프로젝트 목록 조회

- Arrange: 프로젝트 목록 API 응답을 지연시키는 환경을 구성한다.
- Act: `/dashboard/projects` 페이지를 연다.
- Assert: 응답 도착 전에는 스켈레톤 UI가 표시되고, 응답 후 실제 카드 목록으로 대체되며 호출된 API가 성공적으로 완료된다.

### 2. 프로젝트 카드 클릭 (레이블 스튜디오 진입)

- Arrange: 여러 프로젝트가 로드된 상태를 준비한다.
- Act: 특정 프로젝트 카드의 본문을 클릭한다.
- Assert: URL이 `/dashboard/projects/{id}`로 변경되고 해당 프로젝트의 레이블 스튜디오 iframe이 로드된다.

### 3. 프로젝트 편집 다이얼로그

- Arrange: 프로젝트 카드 우측 메뉴를 통해 편집 다이얼로그를 연다.
- Act: 프로젝트 제목과 모델 타입을 수정한 뒤 저장을 선택한다.
- Assert: 수정 요청이 성공하면 다이얼로그가 닫히고 목록이 최신 데이터로 갱신된다.

### 4. 파일 업로드 다이얼로그

- Arrange: 업로드 버튼을 눌러 업로드 다이얼로그를 연다.
- Act: 업로드할 프로젝트를 선택하고 유효한 파일(이미지, PDF, MS오피스, 이들을 포함한 zip 파일)을 추가한 뒤 업로드를 진행한다.
- Assert: 파일 검증을 통과하면 업로드 API가 호출되고, 성공 후 다이얼로그가 닫히며 목록 데이터가 갱신된다.

### 5. 레이블링 결과 다운로드 (추출)

- Arrange: 프로젝트 카드 우측 메뉴에서 "결과 다운로드" 옵션을 선택한다.
- Act: 스냅샷 생성이 완료될 때까지 대기한 후 다운로드를 요청한다.
- Assert: 스냅샷 생성 및 다운로드 요청이 정상 동작하며, 브라우저가 파일 저장 UI를 제공한다.

## 모델

### 1. 모델 목록 조회

- Arrange: 모델 목록 API를 지연 또는 실패하도록 설정한다.
- Act: `/dashboard/models` 페이지를 차례로 로드한다.
- Assert: 지연 시 스켈레톤이 표시되고, 실패 시 에러 Alert 및 재시도 옵션이 나타난다.

### 2. 통계 카드 집계

- Arrange: 서로 다른 타입의 모델 데이터를 포함한 응답을 준비한다.
- Act: 페이지 로드 후 상단 카드의 수치를 확인한다.
- Assert: OCR, Layout, Extraction 카드가 데이터에 기반한 올바른 카운트를 표시한다.

### 3. 모델 이름 검색

- Arrange: 모델 목록이 충분히 표시된 상태를 준비한다.
- Act: 검색 입력에 특정 문자열을 입력하고 지운다.
- Assert: 입력 시 해당 이름을 포함한 행만 남고, 입력 해제 시 전체 목록이 복원된다.

### 4. 행 기반 이동 (모델 상세 조회)

- Arrange: 모델 레코드가 다수 존재하도록 한다.
- Act: 표의 한 행을 클릭하거나 행 메뉴에서 "상세" 옵션을 선택한다.
- Assert: 상세 페이지로 이동하고 선택한 모델 ID에 해당하는 데이터가 로드된다.

## 모델 버저닝

### 1. 모델 버전 목록 및 metrics 조회

- Arrange: `/dashboard/models/{id}` 상세 API가 버전 리스트와 지표 값을 반환하도록 준비한다.
- Act: 특정 모델 상세 페이지를 방문한다.
- Assert: 버전 표가 응답 순서대로 표시되고 Precision, Recall 등 지표 값이 지정된 포맷으로 렌더링된다.

### 2. 모델 버전 Fork

- Arrange: 버전 행의 컨텍스트 메뉴에서 Fork 기능이 노출된 상태를 만든다.
- Act: Fork 옵션을 선택하고 새 버전 이름을 입력한 뒤 생성한다.
- Assert: Fork API 호출이 성공하면 신규 버전이 목록 상단에 추가되고 완료 Toast가 표시된다.

### 3. 모델 버전 기준 추가 학습

- Arrange: 버전 행의 "추가 학습" 버튼이 활성화된 모델을 선택한다.
- Act: 버튼을 클릭해 훈련 페이지로 이동한다.
- Assert: `/dashboard/models/train` 페이지가 열리며 해당 모델과 버전 정보가 선택 영역에 미리 채워진다.

### 4. 모델 버전 삭제

- Arrange: 삭제 권한이 있는 사용자가 버전 메뉴를 열 수 있는 상태를 만든다.
- Act: 삭제 옵션을 클릭하고 확인 다이얼로그에서 승인을 진행한다.
- Assert: 삭제 API 요청이 성공하면 해당 버전이 목록에서 제거되고 빈 상태 메시지가 적절히 표시된다.

## 기본 모델 (API 호출 시 사용) 선택

### 1. 현재 설정된 기본 모델 조회

- Arrange: 기본 모델 목록 API가 현재 기본값을 포함해 응답하도록 한다.
- Act: `/dashboard/models/default` 페이지를 로드한다.
- Assert: 기본값으로 지정된 항목이 선택 상태로 강조되고 관련 메트릭 카드가 채워진다.

### 2. 모델 타입 별 모델 목록 조회

- Arrange: 여러 모델 타입에 대한 버전 데이터가 준비된 상태를 만든다.
- Act: 타입 카드들을 순차적으로 클릭한다.
- Assert: 선택한 타입에 맞는 모델 목록이 오른쪽 패널에 표시되고 다른 타입 데이터는 숨겨진다.

### 3. 모델 타입 별 기본 모델 선택

- Arrange: 특정 타입의 모델 목록을 연 상태에서 기본 모델 업데이트 API가 정상 응답하도록 한다.
- Act: 원하는 버전을 선택하고 "기본으로 설정" 버튼을 누른다.
- Assert: 성공 메시지가 표시되고 기본 모델 목록이 재로딩되어 선택 상태가 반영된다.

### 4. 모델 목록의 모델 선택 시 간략한 metrics 정보 조회

- Arrange: 목록 아이템이 메트릭 요약을 포함하도록 API 응답을 구성한다.
- Act: 모델 목록에서 다른 항목을 선택한다.
- Assert: 선택 즉시 우측 패널에 해당 모델의 Precision, Recall 등 요약 지표가 표시된다.

## 모델 학습

### 1. 파라미터 기반 프리셋 적용

- Arrange: URL에 `type`, `modelId`, `versionId` 파라미터를 포함해 `/dashboard/models/train`에 접근한다.
- Act: 훈련 페이지를 로드한다.
- Assert: 선택 패널이 파라미터 값으로 초기화된다.

### 2. 드롭다운 선택 의존성 (선 선택 항목)

- Arrange: 타입이 선택되지 않은 초기 상태를 유지한다.
- Act: 프로젝트/모델 선택 콤보박스를 열어본다.
- Assert: 타입 선택 전에는 옵션이 비활성화되어 있으며, 타입 선택 후에는 관련 옵션만 표시된다.

### 3. 모델 학습 시작 조건 (필요 항목 선택 완료 시 활성화)

- Arrange: 필수 입력(타입, 데이터셋, 파라미터 등)을 하나씩 선택하며 상태를 관찰한다.
- Act: 마지막 필수 항목을 선택한다.
- Assert: 모든 필수 항목이 채워지면 "훈련 시작" 버튼이 활성화된다.

### 4. 모델 학습 시작

- Arrange: 모든 필수 선택을 완료하고 훈련 API가 수신 가능한 상태를 만든다.
- Act: "훈련 시작" 버튼을 누른다.
- Assert: 요청이 전송되고 버튼이 진행 중 상태로 바뀌며 백그라운드 태스크에 새 항목이 생성된다.

### 5. 모델 학습 경과 조회

- Arrange: 훈련 진행 SSE 이벤트가 다양한 타입(numeric/stage/indeterminate)으로 도착하도록 준비한다.
- Act: 이벤트에 따라 UI 변화를 관찰한다.
- Assert: 진행률, 현재 단계, 메시지가 해당 이벤트 구조에 맞게 갱신된다.

### 6. 모델 학습 취소

- Arrange: 진행 중인 훈련 태스크가 존재하는 상태를 만든다.
- Act: 백그라운드 태스크 팝오버에서 취소 버튼을 클릭한다.
- Assert: 취소 API 요청이 성공하면 훈련이 중단되고 태스크 상태가 `cancelled`로 변경된다.

### 7. 모델 학습 백그라운드 작업 조회

- Arrange: 동시에 여러 훈련 태스크가 존재하도록 데이터를 세팅한다.
- Act: 헤더의 백그라운드 작업 버튼을 클릭해 팝오버를 연다.
- Assert: 진행 중/완료된 태스크가 상태별로 구분돼 표시되고 최근 이벤트가 상단에 정렬된다.

## 모델 학습 모니터링

### 1. 모델 학습 내역 저장

- Arrange: 훈련 완료 이벤트가 발생하도록 SSE 응답을 구성한다.
- Act: 훈련이 완료될 때까지 대기한다.
- Assert: 완료 시점에 로컬 저장소 또는 IndexedDB에 요약 내역이 저장된다.

### 2. 모델 학습 내역 조회

- Arrange: 저장된 훈련 히스토리가 존재하는 상태로 `/dashboard/monitoring/train`에 접근한다.
- Act: 페이지를 최초로 연다.
- Assert: 히스토리 테이블이 저장된 항목을 최신순으로 표시한다.

### 3. 모델 학습 통계 카드 조회

- Arrange: 다양한 상태의 훈련 태스크를 보유한 데이터를 준비한다.
- Act: 페이지 상단의 통계 카드를 확인한다.
- Assert: Running/Completed/Failed/Pending 카드가 각각 올바른 개수를 반영한다.

### 4. 모델 학습 진행 상황 조회

- Arrange: RUNNING 상태의 훈련 태스크가 존재하도록 준비한다.
- Act: 모니터링 페이지를 새로 고친다.
- Assert: 상단 카드와 상세 행에서 경과 시간 및 현재 진행률이 실시간으로 업데이트된다.

## 컨테이너 로그 모니터링

### 1. 컨테이너 목록 조회 및 선택

- Arrange: 로그 서버가 사용 가능한 컨테이너 목록을 반환하도록 한다.
- Act: `/dashboard/monitoring/logs` 페이지를 열어 컨테이너 드롭다운을 클릭한다.
- Assert: 목록이 로딩 스켈레톤 후 실제 컨테이너 이름으로 채워지고 선택 시 입력 필드가 갱신된다.

### 2. 로그 조회 옵션 선택

- Arrange: 로그 검색 옵션(시간 범위, 필터 등)이 표시되는 상태를 구성한다.
- Act: 옵션을 조정한 뒤 적용 버튼을 누른다.
- Assert: 선택한 옵션이 UI에 반영되고 이후 로그 요청에 동일한 파라미터가 사용된다.

### 3. 로그 조회 스트리밍 컨트롤 (시작 / 중단)

- Arrange: 유효한 컨테이너 이름과 로그 스트림 소스를 준비한다.
- Act: 스트리밍을 시작한 뒤 일정 시간 후 중단 버튼을 누른다.
- Assert: 시작 시 실시간 로그가 누적되고 상태가 "스트리밍 중"으로 표시되며, 중단 후 상태가 비활성으로 전환된다.

### 4. 로그 클리어

- Arrange: 로그 목록이 일정량 쌓여 있는 상태를 만든다.
- Act: "로그 비우기" 버튼을 실행한다.
- Assert: 로그 리스트가 초기화되고 빈 상태 메시지가 노출된다.

### 5. 로그 저장

- Arrange: 로그가 누적된 상태에서 다운로드 기능을 사용할 수 있도록 한다.
- Act: "다운로드" 버튼을 클릭한다.
- Assert: 현재 로그를 포함한 파일 생성 요청이 발생하고 브라우저 저장 UI가 나타난다.

## 데모 (그라디오)

### 1. 그라디오 데모 페이지 조회

- Arrange: `NEXT_PUBLIC_CORE_DEMO_URL` 환경 변수를 설정한다.
- Act: `/dashboard/services/gradio` 페이지를 연다.
- Assert: iframe이 지정된 데모 URL을 사용해 렌더링하고 로딩 상태가 성공으로 전환된다.

### 2. 모델 및 모델 버전 선택

- Arrange: 데모 페이지 내 모델/버전 선택 콤보박스가 활성화되는 API 응답을 준비한다.
- Act: 모델과 모델 버전을 순차적으로 선택한다.
- Assert: 선택 결과가 Gradio iframe에 전달되어 입력 위젯이 해당 모델로 갱신된다.

### 3. 레이아웃 인식 결과 출력

- Arrange: 데모 페이지에서 사용할 샘플 문서를 준비해 업로드한다.
- Act: "추론" 버튼을 눌러 데모를 실행한다.
- Assert: 그라디오 출력 패널에 레이아웃 인식 결과가 표시되고 응답 시간이 합리적인 범위 내에 머문다.
